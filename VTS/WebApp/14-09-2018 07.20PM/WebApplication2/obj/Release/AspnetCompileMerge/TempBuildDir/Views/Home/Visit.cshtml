
@{
    ViewBag.Title = "Visit";
    Layout = "~/Views/Shared/Layout1.cshtml";
}

<head>

    <!-- font-awesome icons -->

    <link href="~/MainPage/css/style.css" rel="stylesheet" type="text/css" media="all" />
  
</head>


<body>
    <div class=" container visit">
        <div style="margin-top:70px">
            <div class="row" style=" margin-top: -23px;">

                <div class="col-sm-4 text-center">
                    <div class="dropdown" style="width:100%">
                        <h4>Select Object</h4>
                        <select id="op1" class="dropdownitems radius" style="height:35px;/*margin-left:55px;*/width:100%;"><option value="35"></option></select>
                    </div>
                </div>
                <div class="col-sm-4 text-center">
                    <div class="datetimepickerfrom1">
                        <h4>Date From</h4>
                        <input type="date" name="FromDate" id="from" min="2000-01-02" class="radius" style="width:100%/*margin-left:71px;*/">
                    </div>
                </div>
                <div class="col-sm-4 text-center">
                    <div class="datetimepickerto1">
                        <h4>Date To</h4>
                        <input type="date" name="ToDate" id="To" min="2000-01-02" class="radius" style="width:100%/*margin-left:70px;*/">
                    </div>
                </div>


            </div>
            <div class="text-center">
                <div class=" col-sm-311 text-center">
                    <div class="sbtn" style="margin-top: 28px;">
                        <input type="submit" class="w3-btn1 w3-white1 w3-border sbtn1 radius" value="Show" id="Show" />
                    </div>
                </div>

            </div>
        </div>
    </div>
    <style>

        #map {
            height: 73vh;
            width: 100%;
            margin-left: 0px;
            float: right;
            margin-top: 20px;
            /*box-shadow: 5px 10px #888888;*/
        }

        .popup-tip-anchor {
            height: 0;
            position: absolute;
            /* The max width of the info window. */
            width: 200px;
        }
        /* The bubble is anchored above the tip. */
        .popup-bubble-anchor {
            position: absolute;
            width: 100%;
            bottom: /* TIP_HEIGHT= */ 8px;
            left: 0;
        }
            /* Draw the tip. */
            .popup-bubble-anchor::after {
                content: "";
                position: absolute;
                top: 0;
                left: 0;
                /* Center the tip horizontally. */
                transform: translate(-50%, 0);
                /* The tip is a https://css-tricks.com/snippets/css/css-triangle/ */
                width: 0;
                height: 0;
                /* The tip is 8px high, and 12px wide. */
                border-left: 6px solid transparent;
                border-right: 6px solid transparent;
                border-top: /* TIP_HEIGHT= */ 8px solid white;
            }
        /* The popup bubble itself. */
        .popup-bubble-content {
            position: absolute;
            top: 0;
            left: 0;
            transform: translate(-50%, -100%);
            /* Style the info window. */
            background-color: white;
            padding: 5px;
            border-radius: 5px;
            font-family: sans-serif;
            overflow-y: auto;
            max-height: 60px;
            box-shadow: 0px 2px 10px 1px rgba(0,0,0,0.5);
        }
    </style>
    @*<script src="https://www.google.com/jsapi"></script>*@
    <div class="" style="width:100%;">
        <div id="map" style="border:1px solid #808080"></div>
        <div id="content">

        </div>
        <script>
            $(document).ready(function () {
                $("#op1 option").remove();
                $.ajax({
                    url: "/Home/BindDorpDownVisit",
                    type: "Get",
                    success: function (data) {

                        for (var i = 0; i < data.length; i++) {
                            var opt = new Option(data[i].DeviceName, data[i].DeviceIMEI);
                            $('#op1').append(opt);


                        }

                    }

                })

            });

        </script>
        <script >

           
            $(function () {
                $("#Show").click(function () {
                   
                    var todate = $("#To").val()

                    var fromdate = $("#from").val()

                    if (fromdate == "") {
                        alert("Please Selcet From Date");
                    }
                    else if (todate == "") {
                        alert("Please Selcet To Date");
                    }
                    else {

                      
                        var Dropdown = $("select#op1 option:selected").val()

                        var product = { Dropdown: Dropdown, From: fromdate, To: todate }
                        initMap();
                        $.ajax({

                            type: "POST",
                            contentType: "application/json;charset=utf-8",
                            data: "{product:" + JSON.stringify(product) + "}",
                            url: "/Home/Direction",
                            success: function (data) {
                              
                            
                              


                                    var path = [];
                                    var marker = [];
                                    var contentString = [];
                                    var infowindow = [];
                                    for (var i = 0; i < data.length; i++) {
                                        path = [{ lat: parseFloat(data[i].Lat), lng: parseFloat(data[i].Long) },
                                        { lat: parseFloat(data[i + 1].Lat), lng: parseFloat(data[i + 1].Long) }
                                        ];  // Mt. Whitney
                                        // Create an ElevationService.
                                        elevator = new google.maps.ElevationService;

                                        var lineSymbol = {
                                            path: google.maps.SymbolPath.BACKWARD_CLOSED_ARROW,
                                            strokeColor: 'red',
                                            strokeOpacity: 0.8,

                                        };

                                        if (data[i].State > 32950) {
                                            line = new google.maps.Polyline({
                                                path: path,
                                                strokeColor: '#008dd2',
                                                icons: [{
                                                    icon: lineSymbol,
                                                    offset: '100%',

                                                    strokeOpacity: 0.2,
                                                    offset: '0',
                                                }],

                                                map: map,

                                            });



                                        }


                                        var marker = new google.maps.Marker({
                                            position: { lat: parseFloat(data[0].Lat), lng: parseFloat(data[0].Long) },
                                            map: map,

                                            icon: "../Layout4/images/Playmapgreen.png",
                                            gestureHandling: 'greedy'

                                        });
                                        map.setZoom(16);
                                        map.panTo(marker.position);



                                        marker[i] = new google.maps.Marker({
                                            position: { lat: parseFloat(data[i].Lat), lng: parseFloat(data[i].Long) },
                                            map: map,
                                            // animation: google.maps.Animation.BOUNCE,
                                            icon: "None"

                                        });


                                    }




                               
                                    }
                              
                                })


                            }
                   
                        })
             
                    });

        </script>
        <script>


            // Load the Visualization API and the columnchart package.
            google.load('visualization', '1', { packages: ['columnchart'] });
            var map;
            var elevator;
            function initMap() {
                // The following path marks a path from Mt. Whitney, the highest point in the
                // continental United States to Badwater, Death Valley, the lowest point.
                map = new google.maps.Map(document.getElementById('map'), {
                    zoom: 5,
                    center: { lat: 20.593684, lng: 78.962880 },
                });

            }




        </script>


        <script async defer
                src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDw6ylNYYy1CPEN_shphTXMhf-2yGCDXuI&callback=initMap">
        </script>
    </div>
    <div class="visitfooter"></div>
</body>


