
@{
    ViewBag.Title = "ReportsSpeedVoilation";
    Layout = null;
}
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <script src="~/MainPage/js/jquery-1.9.1.min.js"></script>
        @*<script src="~/MainPage/js/easyResponsiveTabs.js"></script>*@
        <script type="text/javascript" src="~/MainPage/js/jquery-2.1.4.min.js"></script>
        <link href="~/MainPage/css/style.css" rel="stylesheet" type="text/css" media="all" />
        <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
        <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
        <script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
        <link href="~/MainPage/css/bootstrap.css" rel="stylesheet" />
        <link href="~/MainPage/css/style.css" rel="stylesheet" />
        <link href="~/MainPage/css/circle.css" rel="stylesheet" />
        <link rel="stylesheet" href="~/MainPage/css/font-awesome.min.css" />
        <script src="~/Scripts/index.js"></script>
        <style>
            table.scroll {
                /* width: 100%; */ /* Optional */
                /* border-collapse: collapse; */
                border-spacing: 0;
                border: 1px solid black;
            }

                table.scroll tbody
                ,table.scroll thead {
                    display: block;
                }

                    table.scroll thead tr th {
                        height: 30px;
                        line-height: 30px;
                        /* text-align: left; */ 
                    }

                table.scroll tbody {
                    height: 100px;
                    overflow-y: auto;
                    overflow-x: hidden;
                    height: 380px;
                }

                table.scroll tbody {
                    border-top: 1px solid black;
                }

                    table.scroll tbody td, thead th {
                         width: 20%; /* Optional */
                        /*border-right: 1px solid black;*/
                        /* white-space: nowrap; */
                    }

                        table.scroll tbody td:last-child, thead th:last-child {
                            border-right: none;
                        }
                        colors{
                            color:black;
                        }
        </style>
    </head>
   
    <body>
        <!--Header-->
        <div class="header" style="padding:0em">
            <div class="container-fluid">
                <div class="address-info">
                    <nav class="navbar navbar-default">

                        <div class="navbar-header navbar-left">
                            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                                <span class="sr-only">Toggle navigation</span>
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                            </button>
                            <h1><a class="navbar-brand"><a href="@Url.Action("MainPage", "Home")"> <img src="~/Layout4/images/AVISCO10.png" style="height: 79px;width: 155px;margin-bottom: -11px;margin-top: -7px; float:left" title=""> </a></h1>
                        </div>
                        <div class="collapse navbar-collapse navbar-right" id="bs-example-navbar-collapse-1">
                            <nav class="cl-effect-13" id="cl-effect-13">
                                <ul class="nav navbar-nav">
                                    <li class="active1">
                                        <a href="@Url.Action("MainPage", "Home")"><i class="fa fa-wifi" class="imgstyle" title="Live Tracking" id="signInButton"></i></a>
                                        <span class="hedtxt">Live</span>
                                    </li>
                                    <li>
                                        <a href="@Url.Action("DashBoard", "Home")" target="_blank">
                                            <i class="fa fa-desktop" class="imgstyle" style="text-align:center;padding-left:5px;"></i>
                                        </a><span class="hedtxt">Dashboard</span>
                                    </li>
                                    <li id="load">
                                        <a href="@Url.Action("Log", "Home")" target="_blank">
                                            <i class="fa fa-list-alt" class="imgstyle" style=""></i>
                                        </a><span class="hedtxt">Logs</span>
                                    </li>
                                    <li>
                                        <a href="@Url.Action("Reports", "Home")" target="_blank">
                                            <i class="fa fa-chart-bar imgstyle1" style="margin-right:1px;"></i>
                                        </a><span class="hedtxt">Report</span>
                                    </li>
                                    <li>
                                        <a href="@Url.Action("Visit", "Home")" target="_blank">
                                            <i class="fa fa-map-marker" class="imgstyle" style="padding-left:5px;"></i>
                                        </a><span class="hedtxt">Tracking</span>
                                    </li>

                                    <li>
                                        <a><i class="fa fa-user" class="imgstyle" onclick="myFunction()" title="@Request.RequestContext.HttpContext.Session["username"]" id="fauser"></i></a>
                                        <span class="hedtxt" style="margin-left: 6px;">User</span>
                                        <div class="dropdown" style="width: 100%;
    margin-left: -73px;">

                                            <div id="myDropdown" class="dropdown-content" style="  width: 257%;
    margin-left: -81px;
    margin-top: 15px;
    height: 114px;
    border: 1px solid;
    border-radius: 40px;
    background: white;">
                                                <a href="#">
                                                    <i class="fa fa-user" class="imgstyle" style="    font-size: 30px;
    margin-right: 4px;"></i>
                                                </a>
                                                <span><label>@Request.RequestContext.HttpContext.Session["username"]</label></span>
                                                <br />
                                                <a href="@Url.Action("ChangePassword", "Home")" target="_blank">
                                                    <lable id="change">Change Password</lable>
                                                </a><div style="margin-top: 0px;">
                                                    <a id="LogOut">
                                                        <i class="fa fa-sign-out" class="imgstyle" title="LogOut" id="LogOut">Logout</i>
                                                    </a>

                                                </div>

                                            </div>



                                        </div>
                                    </li>
                                    <a style="visibility: hidden;" href="/Login.aspx" id="logout1">aa</a>

                                </ul>
                            </nav>
                        </div>
                </div>
                </nav>
            </div>
        </div>
        <!--Header-->
        <div class="container-fluid">

            <div class="col-md-12">
                <h2 class="" style="margin-top:50px ;background:#888888;font-size:25px;margin-bottom:0px;">
                    Reports Speed Voilation<span style="float:right">
                        <a href="#" id="SPdf"><i class="fa fa-file-pdf-o" aria-hidden="true" id="SPdf" style="color:red;text-align:center;background-color:white"></i></a>
                        <a href="#" id="SExcel"><i class="fa fa-file-excel-o" aria-hidden="true" id="SExcel" style="color:green;text-align:center;background-color:white"></i></a>
                    </span>
                </h2>
            </div>
        </div>


        <div class=" container-fluid" style="margin-top:0px">

            <div class=" col-md-12">
                <div class="logbox1">
                    <table class="table table-striped " style="overflow-y: auto;">
                        <thead>
                            <tr>
                                <td colspan="6" style="  color: black;">
                                    Report Duration:<label id="todate" class="colors"> @ViewBag.To</label>- <label id="fromdate">@ViewBag.From</label>
                                </td>
                            </tr>
                        </thead>

                        <thead>
                            <tr>
                                <td colspan="6" style="color: black;">Asset Name:<label id="vehicle_no"> @ViewBag.Vehicle_No</label></td>
                            </tr>
                        </thead>
                        <thead>
                            <tr>
                                <td style="style=" color: black;">Asset Group:</td>
                                <td colspan="6" style="    color: black;"><label id="vehicle_type">@ViewBag.type</label></td>


                            </tr>
                        </thead>

                        <thead style="background:#888888">
                            <tr class=" header" style="background:#888888;font-size:12px;">
                                <th style=" color:black;background-color:transparent;">Vehicle No.</th>
                                <th style=" color:black;background-color:transparent;">Date</th>
                                <th style=" color:black;background-color:transparent;">Time</th>
                                <th style=" color:black;background-color:transparent;text-align: right;" colspan="2">Location</th>
                                <th style=" color:black;background-color:transparent;"></th>
                                <th style=" color:black;background-color:transparent;">Speed</th>
                            </tr>
                        </thead>


                        <tbody id="Log" style="height:370px"></tbody>
                    </table>
                    <div class="container-fluid" style="text-align:center" id="L1">
                        <img src="/MainPage/images/preloader.gif" style="height: 50px;">
                    </div>
                </div>
            </div>
        </div>
        <div class="footerspace"></div>
        @*Footrt*@
        <div class="footer-w3layouts" style=" position: fixed;
    left: 0;
    bottom: 0;
    width: 100%;
    background: white;">
            <div class="agile-copy1" style="border:1px solid #e4e2e2">
                <div style="float:left;line-height: 30px;"> Copyright © 2018. All rights reserved | Design by <a href="http://www.aviscoitsolutions.com">AVISCO IT SOLUTIONS PRIVATE LIMITED.</a></div>
                <div style="float:right" class="frfr">
                    <ul>
                        <li><a href="#"><i class="fa fa-facebook" style="1color:#3b579d"></i></a></li>
                        <li><a href="#"><i class="fa fa-twitter" style="1color:#00c1f7"></i></a></li>
                        <li><a href="#"><i class="fa fa-linkedin" aria-hidden="true" style="1color:#0076b4"></i></a></li>
                        <li><a href="#"><i class="fa fa-google-plus" aria-hidden="true" style="1color:#b12f21"></i></a></li>

                    </ul>
                </div>
            </div>
        </div>
        @*footer*@
        <script type="text/javascript">

            $(document).ready(function () {

                var todate = $("#todate").text()
                var fromdate = $("#fromdate").text()
                var Dropdown = $("#vehicle_no").text()
                var product = { Dropdown: Dropdown, From: fromdate, To: todate }
                $.ajax({
                    type: "POST",
                    contentType: "application/json",
                    data: "{product:" + JSON.stringify(product) + "}",
                    url: "/Home/SpeedLog",
                    success: function (data) {


                        if (data.length == 0) {
                            alert("No Records Found!!")

                        }
                        else {
                            var add = "";
                            var setdata = $("#Log");
                            var lng;
                            var lng;
                            var latlng;
                            var geocoder;
                            for (var i = 0; i < data.length; i++) {
                                var milisegundos = parseInt(data[i].Date.replace("/Date(", "").replace(")/", ""));
                                var newDate = new Date(milisegundos).toLocaleDateString("en-UE");
                                var Time = new Date(milisegundos).toLocaleTimeString("en-UE");
                                var data2 = "<tr onclick='showmap(this)' class='row_" + data[i].id + "'>" +
                                    "<td style='color: black'>" + data[i].DeviceName + "</td>" +
                                    "<td style='color: black'>" + newDate + "</td>" +
                                    "<td style='color: black'>" + Time + "</td>" +
                                    "<td style='color: blue'>" + data[i].Lat + "</td>" +
                                    "<td style='color: blue'>" + data[i].Long + "</td>" +
                                    "<td style='color: Red;width: 36%;text-align: center;'>" + data[i].speed + "</td>" +
                                    "</tr>";

                                setdata.append(data2)
                                $("#L1").hide();

                            }
                        }
                    }
                })
            });
        </script>
        <script type="text/javascript">

            document.getElementById("LogOut").addEventListener("click", expire);
            function expire() {
                document.getElementById("logout1").click();
                $.ajax({
                    type: "POST",
                    contentType: "application/json;charset=utf-8",
                    //data: "{product:" + JSON.stringify(product) + "}",
                    url: "/Home/expire",
                    success: function (data) {

                    }
                })
            }
             function showmap(r) {

        t = document.getElementById('Log').rows;
        var al,al1;

        var celval = new Array()
        var celval1 = new Array()
        for (var i = 0; i < t.length; i++) {
            for (var j = 0; j < t[i].cells.length; j++) {
                if (r == t[i]) {
                    celval[j] = t[i].cells[3].innerHTML;
                    celval1[j] = t[i].cells[4].innerHTML;
                    al = celval[j].toString();
                    al1 = celval1[j].toString();
                }
            }

        }

        var lat = al;
        var long = al1

          var url = '@Html.Raw(Url.Action("ShowLogLocation", "Home", new { Lat = "__Lat1__", Long = "__Long1__" }))';

          var params = url.replace('__Lat1__', al).replace('__Long1__', al1);

          window.location.href = params;

    }

            $(function () {

                $("#SPdf").click(function () {
                  var todate = $("#todate").text()
                    var fromdate = $("#fromdate").text()
                    var Vno = $("#vehicle_no").text()
                    var url = '@Html.Raw(Url.Action("OverSpeedReportPdf", "Home", new {vno = "__orderId__", from1 = "__employeeId__", to = "__employeeId1__" }))';

                    var params = url.replace('__orderId__', Vno).replace('__employeeId__', fromdate).replace('__employeeId1__', todate);

                    window.location.href = params;
                });
                });
                 $(function () {

                     $("#SExcel").click(function () {

                    var todate = $("#todate").text()
                    var fromdate = $("#fromdate").text()
                    var Vno = $("#vehicle_no").text()
                    var url = '@Html.Raw(Url.Action("OverSpeedReportExcel", "Home", new {vno = "__orderId__", from1 = "__employeeId__", to = "__employeeId1__" }))';
                    var params = url.replace('__orderId__', Vno).replace('__employeeId__', fromdate).replace('__employeeId1__', todate);
                    window.location.href = params;
                });
            });
        </script>
    </body>
</html>